{{- /*
Renders a menu for the given menu ID.

@context {page} page The current page.
@context {string} menuID The menu name/ID from site config.

@example: {{ partial "menu.html" (dict "menuID" "main" "page" .) }}
*/}}

{{ $page := .page }}
{{ $menuID := .menuID }}

{{ with index site.Menus $menuID }}
  <nav>
    <div class="nav-items">
      {{- range . }}
          {{- $linkAttrs := dict "href" .URL }}

          <!-- Determine if nav item is current page or ancestor of current page
           and assign classes accordingly; TODO understand aria/accessibility features better -->
          {{- if $page.IsMenuCurrent .Menu . }}
              {{- $linkAttrs = merge $linkAttrs (dict "class" "active" "aria-current" "page") }}
          {{ else if $page.HasMenuCurrent .Menu .}}
              {{ $linkAttrs = merge $linkAttrs (dict "class" "ancestor" "aria-current" "true") }}
          {{- end }}

          <!-- Format HTML attributes for insertion into link element -->
          {{ $linkAttrsStr := "" }}
          {{ range $k, $v := $linkAttrs }}
              {{ with $v }}
                  {{ $linkAttrsStr = printf "%s %s=%q" $linkAttrsStr $k $v | safeHTMLAttr }}
              {{ end }}
          {{ end }}

        <span class="nav-item">
          <a {{ $linkAttrsStr }}>/{{ .Name }}</a>
        </span>
        {{ end }}
    </div>

  </nav>
  <hr class="nav-hr-bottom">
{{ end }}
